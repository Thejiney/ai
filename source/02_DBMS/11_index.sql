-- [XI] 인데스 : 조회를 빠르게 하는 인덱스
DROP TABLE EMP01;
CREATE TABLE EMP01 AS
SELECT * FROM EMP; -- EMP 테이블과 내용이 같은 EMP01;
SELECT * FROM EMP01; -- 14행
INSERT INTO EMP01
	SELECT * FROM EMP01; -- 데이터 뻥튀기 1번(28행) 2번(56행)
	
SELECT TO_CHAR(COUNT(*), '9,999,999') CNT
FROM EMP01;

INSERT INTO EMP01
	SELECT * FROM EMP01; -- 11번 (11만개)
	
SELECT TO_CHAR(COUNT(*), '9,999,999') CNT
FROM EMP01; --11만개

INSERT INTO EMP01 (EMPNO, ENAME, DEPTNO)
VALUES (1111, '홍길동', 40);

INSERT INTO EMP01
	SELECT * FROM EMP01; --1번 (22만), 2번(44만), 3번(90만)

SELECT TO_CHAR(COUNT(*), '9,999,999') CNT
FROM EMP01; --91만개

SELECT * FROM EMP01 WHERE ENAME='홍길동'; -- 인덱스 없이 조회(0.024초)


-- 인덱스 생성
CREATE INDEX IDX_EMP01_ENAME ON EMP01(ENAME); -- (0.543초)
SELECT * FROM EMP01 WHERE ENAME='홍길동'; -- 인덱스 생성 후 조회(0.003초)

COMMIT;

INSERT INTO EMP01 SELECT * FROM EMP01; -- 인덱스생성후 91만 -> 182만개 (40.508초)

SELECT TO_CHAR(COUNT(*), '9,999,999') CNT
FROM EMP01; --183만개

ROLLBACK; -- 17.417초

DROP INDEX IDX_EMP01_ENAME; -- 인덱스 삭제

SELECT TO_CHAR(COUNT(*), '9,999,999') CNT
FROM EMP01; --91만개

INSERT INTO EMP01 SELECT * FROM EMP01; -- 91만 -> 182만개 (3.77초)

ROLLBACK; -- 0.19초

DROP TABLE EMP01; -- 테이블 지우면 해당 테이블의 인덱스는 자동 삭제 